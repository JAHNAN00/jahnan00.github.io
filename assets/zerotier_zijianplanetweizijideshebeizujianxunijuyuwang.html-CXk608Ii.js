import{_ as t,c as r,b as a,d as s,e as n,a as l,r as o,o as d}from"./app-BSN6UQvI.js";const p="/assets/image-20251110023314046-Q5XUdt-Q.png",c="/assets/image-20251110024731078-dCsmD6Fa.png",u="/assets/image-20251110025108310-Bu_3Zgqf.png",h="/assets/image-20251110030705191-BYUoWqwb.png",m={},b={href:"https://www.zerotier.com/download/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://key-networks.com/ztncui/#installation",target:"_blank",rel:"noopener noreferrer"};function g(k,e){const i=o("ExternalLinkIcon");return d(),r("div",null,[e[4]||(e[4]=a('<h2 id="zerotier-是什么" tabindex="-1"><a class="header-anchor" href="#zerotier-是什么"><span>ZeroTier 是什么</span></a></h2><p>ZeroTier 是一个虚拟网络工具，可以把分散在不同网络环境中的设备，连接成一个“像在同一局域网里”的私有网络。</p><p>例如：你在教室的笔记本，需要访问宿舍里的台式机或家庭服务器。传统做法是内网穿透（如 FRP），而 ZeroTier 更偏向“组网”，让设备之间直接通过虚拟 IP 互联。</p><h2 id="使用前说明" tabindex="-1"><a class="header-anchor" href="#使用前说明"><span>使用前说明</span></a></h2><p>为了避免概念混淆，先统一几个术语：</p><ol><li><p>FRP 这类内网穿透方案，通常需要一台公网可访问的中转服务器（常见是云服务器），不一定要求家里设备本身有公网 IP。</p></li><li><p>自建方案里常见两部分：</p><ul><li>控制器（controller），负责网络管理和设备授权</li><li>私有根配置（moon/planet 文件），用于特定网络环境下的节点发现与加速<br> 这两者不是同一个组件。</li></ul></li><li><p>moon/planet 属于进阶配置，并非所有场景都必须使用；常规场景优先保证控制器和设备授权流程可用。</p></li></ol><h2 id="安装-zerotier-客户端" tabindex="-1"><a class="header-anchor" href="#安装-zerotier-客户端"><span>安装 ZeroTier 客户端</span></a></h2>',7)),s("p",null,[e[1]||(e[1]=n("下载页：",-1)),s("a",b,[e[0]||(e[0]=n("https://www.zerotier.com/download/",-1)),l(i)])]),e[5]||(e[5]=a(`<h3 id="windows" tabindex="-1"><a class="header-anchor" href="#windows"><span>Windows</span></a></h3><p>下载 MSI 安装包后安装。<br> 默认数据目录：<code>C:\\ProgramData\\ZeroTier\\One</code></p><h3 id="macos" tabindex="-1"><a class="header-anchor" href="#macos"><span>macOS</span></a></h3><p>下载 PKG 安装包后安装。<br> 默认数据目录：<code>/Library/Application Support/ZeroTier/One</code></p><h3 id="ubuntu-debian" tabindex="-1"><a class="header-anchor" href="#ubuntu-debian"><span>Ubuntu / Debian</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">curl</span> <span class="token parameter variable">-s</span> https://install.zerotier.com <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">bash</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>默认数据目录：<code>/var/lib/zerotier-one</code></p><h2 id="基础用法-加入网络" tabindex="-1"><a class="header-anchor" href="#基础用法-加入网络"><span>基础用法：加入网络</span></a></h2><p>Windows 和 macOS 可用图形界面加入网络：</p><p><img src="`+p+`" alt="image-20251110023314046"></p><p>Linux 命令行：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">zerotier-cli <span class="token function">join</span> <span class="token variable">$YOUR_NET_ID</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>$YOUR_NET_ID</code> 是网络 ID（不是节点 ID）。</p><p>如果你使用官方托管控制器（my.zerotier.com），首次加入后需要在控制台的 <code>Members</code> 中将设备设为 <code>Authorized</code>，并给设备分配虚拟网段 IP（自动或手动都可）。</p><p>连通性可用以下方式验证：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">ping</span> <span class="token variable">$PEER_ZT_IP</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="自建控制器-使用-ztncui" tabindex="-1"><a class="header-anchor" href="#自建控制器-使用-ztncui"><span>自建控制器：使用 ztncui</span></a></h2><p>如果你希望自己管理网络控制平面，可以在服务器上部署 ztncui（ZeroTier 控制器 UI）。</p>`,18)),s("p",null,[e[3]||(e[3]=n("参考：",-1)),s("a",v,[e[2]||(e[2]=n("https://key-networks.com/ztncui/#installation",-1)),l(i)])]),e[6]||(e[6]=a(`<h3 id="_1-安装-ztncui" tabindex="-1"><a class="header-anchor" href="#_1-安装-ztncui"><span>1) 安装 ztncui</span></a></h3><p>示例（版本号可能变化）：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">curl</span> <span class="token parameter variable">-O</span> https://s3-us-west-1.amazonaws.com/key-networks/deb/ztncui/1/x86_64/ztncui_0.8.14_amd64.deb</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> ./ztncui_0.8.14_amd64.deb</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>创建 <code>.env</code>：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">&quot;echo ZT_TOKEN=<span class="token variable"><span class="token variable">\`</span><span class="token function">sudo</span> <span class="token function">cat</span> /var/lib/zerotier-one/authtoken.secret<span class="token variable">\`</span></span> &gt; /opt/key-networks/ztncui/.env&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>追加配置：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token assign-left variable">HTTPS_PORT</span><span class="token operator">=</span><span class="token number">3443</span></span>
<span class="line"><span class="token assign-left variable">NODE_ENV</span><span class="token operator">=</span>production</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>设置权限：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">400</span> /opt/key-networks/ztncui/.env</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">chown</span> ztncui.ztncui /opt/key-networks/ztncui/.env</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>启动并检查：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> systemctl restart ztncui</span>
<span class="line"><span class="token function">sudo</span> systemctl status ztncui</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>浏览器访问 <code>https://&lt;SERVER_IP&gt;:3443</code>。若未配置证书，出现 HTTPS 警告属正常现象。</p><h3 id="_2-初始化控制台" tabindex="-1"><a class="header-anchor" href="#_2-初始化控制台"><span>2) 初始化控制台</span></a></h3><p>首次登录默认账号通常为：</p><ul><li>用户名：<code>admin</code></li><li>密码：<code>password</code></li></ul><p><img src="`+c+'" alt="image-20251110024731078"></p><p>建议立即修改默认密码，或新建管理员并停用默认账户。</p><p>在 <code>Networks</code> 页面创建网络，记下 <code>Network ID</code>：</p><p><img src="'+u+`" alt="image-20251110025108310"></p><h2 id="可选进阶-制作并下发-planet-文件-私有根" tabindex="-1"><a class="header-anchor" href="#可选进阶-制作并下发-planet-文件-私有根"><span>可选进阶：制作并下发 planet 文件（私有根）</span></a></h2><p>这一步不是所有场景都必须，只有在你明确需要私有根时再做。</p><p>先生成 <code>moon.json</code>：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token builtin class-name">cd</span> /var/lib/zerotier-one</span>
<span class="line">zerotier-idtool initmoon identity.public <span class="token operator">&gt;</span> moon.json</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>编辑 <code>moon.json</code>，在 <code>stableEndpoints</code> 中写入公网 IP 和端口（通常为 <code>9993</code>）。</p><p>然后生成 <code>planet</code>（world）文件：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">cp</span> /var/lib/zerotier-one/moon.json ./</span>
<span class="line">./mkmoonworld-x86_64 ./moon.json</span>
<span class="line"><span class="token function">mv</span> world.bin planet</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>把 <code>planet</code> 分发到客户端数据目录（上文各系统目录），并备份旧文件：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">mv</span> planet planet.old</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="重启客户端并验证" tabindex="-1"><a class="header-anchor" href="#重启客户端并验证"><span>重启客户端并验证</span></a></h2><h3 id="macos-1" tabindex="-1"><a class="header-anchor" href="#macos-1"><span>macOS</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> launchctl unload /Library/LaunchDaemons/com.ZeroTier.one.plist</span>
<span class="line"><span class="token function">sudo</span> launchctl load /Library/LaunchDaemons/com.ZeroTier.one.plist</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="linux" tabindex="-1"><a class="header-anchor" href="#linux"><span>Linux</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> systemctl restart zerotier-one.service</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="windows-1" tabindex="-1"><a class="header-anchor" href="#windows-1"><span>Windows</span></a></h3><p>在“服务”管理器中重启 ZeroTier 服务。</p><p>检查是否能发现预期对端/根节点：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">zerotier-cli listpeers</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>最后让设备加入目标网络，并在控制器侧授权：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">zerotier-cli <span class="token function">join</span> <span class="token variable">$YOUR_NET_ID</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果设备在后台显示在线，且相互 <code>ping</code> 通，则组网成功。</p><p><img src="`+h+'" alt="image-20251110030705191"></p><p>至此，你就可以通过 ZeroTier 分配的虚拟 IP 进行 SSH、远程桌面或文件传输。</p>',42))])}const f=t(m,[["render",g]]),w=JSON.parse('{"path":"/blogs/zerotier_zijianplanetweizijideshebeizujianxunijuyuwang.html","title":"zerotier+自建planet为设备组建虚拟局域网","lang":"zh-CN","frontmatter":{"title":"zerotier+自建planet为设备组建虚拟局域网","date":"2025/02/06","tags":["Web","物联网","多设备"],"categories":["实用工具"]},"headers":[{"level":2,"title":"ZeroTier 是什么","slug":"zerotier-是什么","link":"#zerotier-是什么","children":[]},{"level":2,"title":"使用前说明","slug":"使用前说明","link":"#使用前说明","children":[]},{"level":2,"title":"安装 ZeroTier 客户端","slug":"安装-zerotier-客户端","link":"#安装-zerotier-客户端","children":[{"level":3,"title":"Windows","slug":"windows","link":"#windows","children":[]},{"level":3,"title":"macOS","slug":"macos","link":"#macos","children":[]},{"level":3,"title":"Ubuntu / Debian","slug":"ubuntu-debian","link":"#ubuntu-debian","children":[]}]},{"level":2,"title":"基础用法：加入网络","slug":"基础用法-加入网络","link":"#基础用法-加入网络","children":[]},{"level":2,"title":"自建控制器：使用 ztncui","slug":"自建控制器-使用-ztncui","link":"#自建控制器-使用-ztncui","children":[{"level":3,"title":"1) 安装 ztncui","slug":"_1-安装-ztncui","link":"#_1-安装-ztncui","children":[]},{"level":3,"title":"2) 初始化控制台","slug":"_2-初始化控制台","link":"#_2-初始化控制台","children":[]}]},{"level":2,"title":"可选进阶：制作并下发 planet 文件（私有根）","slug":"可选进阶-制作并下发-planet-文件-私有根","link":"#可选进阶-制作并下发-planet-文件-私有根","children":[]},{"level":2,"title":"重启客户端并验证","slug":"重启客户端并验证","link":"#重启客户端并验证","children":[{"level":3,"title":"macOS","slug":"macos-1","link":"#macos-1","children":[]},{"level":3,"title":"Linux","slug":"linux","link":"#linux","children":[]},{"level":3,"title":"Windows","slug":"windows-1","link":"#windows-1","children":[]}]}],"git":{"createdTime":1738692639000,"updatedTime":1772137037000,"contributors":[{"name":"JAHNAN00","email":"892961012@qq.com","commits":1}]},"filePathRelative":"blogs/zerotier_自建planet为自己的设备组建虚拟局域网.md"}');export{f as comp,w as data};
